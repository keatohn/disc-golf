version: 2

models:
  - name: dim_course
    description: "Dimension table for disc golf courses, including custom courses without object IDs"
    columns:
      - name: course_sk
        description: "Surrogate key for the course"
        tests:
          - unique
          - not_null
      - name: course_id
        description: "Original course ID from UDisc (may be null for custom courses)"
        tests:
          - unique
      - name: course_name
        description: "Name of the course"
        tests:
          - not_null
      - name: is_custom
        description: "Whether this is a custom course"
      - name: created_at
        description: "When the course was first created"
      - name: updated_at
        description: "When the course was last updated"

  - name: dim_layout
    description: "Dimension table for course layouts, including custom layouts without object IDs"
    columns:
      - name: layout_sk
        description: "Surrogate key for the layout"
        tests:
          - unique
      - name: layout_id
        description: "Original layout ID from UDisc (may be null for custom layouts)"
        tests:
          - unique
      - name: layout_name
        description: "Name of the layout"
        tests:
          - not_null
      - name: course_sk
        description: "Foreign key to dim_course"
        tests:
          - not_null
          - relationships:
              to: ref('dim_course')
              field: course_sk
      - name: is_custom
        description: "Whether this is a custom layout"
      - name: created_at
        description: "When the layout was first created"
      - name: updated_at
        description: "When the layout was last updated"

  - name: dim_hole
    description: "Dimension table for holes on courses and layouts"
    columns:
      - name: hole_sk
        description: "Surrogate key for the hole"
        tests:
          - unique
      - name: hole_id
        description: "Unique identifier for the hole"
        tests:
          - unique
      - name: hole_name
        description: "Name of the hole"
      - name: hole_number
        description: "Hole number on the layout"
      - name: par
        description: "Par for this hole"
      - name: distance
        description: "Distance of this hole in feet"
      - name: dogleg_count
        description: "Number of doglegs on this hole"
      - name: created_at
        description: "When the hole was first created"
      - name: updated_at
        description: "When the hole was last updated"

  - name: dim_player
    description: "Dimension table for disc golf players"
    columns:
      - name: player_sk
        description: "Surrogate key for the player"
        tests:
          - unique
      - name: player_id
        description: "Original player ID from UDisc (may be null for custom players)"
        tests:
          - unique
      - name: full_name
        description: "Full name of the player"
      - name: first_name
        description: "First name of the player"
      - name: last_name
        description: "Last name of the player"
      - name: display_name
        description: "Display name of the player"
      - name: username
        description: "Username of the player"
        tests:
          - not_null
      - name: is_udisc_user
        description: "Whether this is a UDisc user"
      - name: is_deleted
        description: "Whether this player has been deleted"
      - name: created_by_player_sk
        description: "Foreign key to dim_player (who created this player)"
        tests:
          - relationships:
              to: ref('dim_player')
              field: player_sk
      - name: created_at
        description: "When the player was first created"
      - name: updated_at
        description: "When the player was last updated"

  - name: dim_team
    description: "Dimension table for disc golf teams (doubles, triples, etc.)"
    columns:
      - name: team_sk
        description: "Surrogate key for the team"
        tests:
          - unique
          - not_null
      - name: team_id
        description: "Unique identifier for the team (concatenated player IDs)"
        tests:
          - unique
      - name: team_name
        description: "Display name for the team"
      - name: team_type
        description: "Type of team (Doubles, Triples, Team)"
      - name: created_at
        description: "When the team was first created"
      - name: updated_at
        description: "When the team was last updated"

  - name: fct_scorecard
    description: "Fact table for scorecards representing group outings on a layout"
    columns:
      - name: scorecard_sk
        description: "Surrogate key for the scorecard"
        tests:
          - unique
          - not_null
      - name: scorecard_id
        description: "Original scorecard ID"
        tests:
          - not_null
      - name: layout_sk
        description: "Foreign key to dim_layout"
        tests:
          - not_null
          - relationships:
              to: ref('dim_layout')
              field: layout_sk
      - name: start_date
        description: "When the scorecard outing started"
      - name: end_date
        description: "When the scorecard outing ended"
      - name: duration_minutes
        description: "Duration of the scorecard outing in minutes"
      - name: starting_hole
        description: "Starting hole number for the outing"
      - name: scorecard_name
        description: "Custom name for the scorecard"
      - name: miles_travelled
        description: "Total miles travelled during the outing"
      - name: step_count
        description: "Total step count during the outing"
      - name: floors_ascended
        description: "Number of floors ascended"
      - name: floors_descended
        description: "Number of floors descended"
      - name: temperature
        description: "Temperature during the outing in Fahrenheit"
      - name: wind_direction
        description: "Wind direction (cardinal direction)"
      - name: wind_speed
        description: "Wind speed in miles per hour"
      - name: humidity_percent
        description: "Humidity percentage during the outing"
      - name: cloud_cover_percent
        description: "Cloud cover percentage during the outing"
      - name: notes
        description: "Additional notes about the outing"
      - name: uses_valid_smart_layout
        description: "Whether the layout uses valid smart layout"
      - name: is_finished
        description: "Whether the scorecard is finished"
      - name: is_public
        description: "Whether the scorecard is public"
      - name: is_deleted
        description: "Whether the scorecard is deleted"
      - name: version
        description: "Version of the scorecard data"
      - name: created_by_player_sk
        description: "Foreign key to dim_player (who created the scorecard)"
        tests:
          - relationships:
              to: ref('dim_player')
              field: player_sk
      - name: created_at
        description: "When the scorecard was created"
      - name: updated_at
        description: "When the scorecard was last updated"

  - name: fct_round
    description: "Fact table for individual player rounds within a scorecard"
    columns:
      - name: round_sk
        description: "Surrogate key for the round"
        tests:
          - unique
          - not_null
      - name: round_id
        description: "Unique identifier for the round (entry_id)"
        tests:
          - not_null
      - name: scorecard_sk
        description: "Foreign key to fct_scorecard"
        tests:
          - not_null
          - relationships:
              to: ref('fct_scorecard')
              field: scorecard_sk
      - name: player_sk
        description: "Foreign key to dim_player"
        tests:
          - relationships:
              to: ref('dim_player')
              field: player_sk
      - name: team_sk
        description: "Foreign key to dim_team"
        tests:
          - relationships:
              to: ref('dim_team')
              field: team_sk
      - name: round_type
        description: "Type of round (Singles, Doubles, Triples, Team)"
      - name: round_starting_score
        description: "Starting score for the round"
      - name: round_strokes
        description: "Total strokes for the round"
      - name: round_par
        description: "Total par for the round"
      - name: round_score
        description: "Score relative to par"
      - name: round_score_display
        description: "Formatted score display (E, +1, -2, etc.)"
      - name: round_rating_udisc
        description: "UDisc rating for the round"
      - name: created_at
        description: "When the round was created"
      - name: updated_at
        description: "When the round was last updated"

  - name: fct_round_hole
    description: "Fact table for hole-by-hole performance within individual rounds"
    columns:
      - name: round_hole_sk
        description: "Surrogate key for the round hole performance record"
        tests:
          - unique
      - name: scorecard_id
        description: "Original scorecard ID"
        tests:
          - not_null
      - name: entry_id
        description: "Foreign key to fct_round"
        tests:
          - not_null
          - relationships:
              to: ref('fct_round')
              field: round_id
      - name: player_sk
        description: "Foreign key to dim_player"
        tests:
          - not_null
          - relationships:
              to: ref('dim_player')
              field: player_sk
      - name: hole_number
        description: "Hole number on the course"
        tests:
          - not_null
      - name: hole_strokes
        description: "Number of strokes taken on this hole"
        tests:
          - not_null
      - name: change_version
        description: "Version of the hole data"
      - name: holes_updated_at
        description: "When the holes were last updated"
      - name: last_updated_at
        description: "When this record was last updated"
      - name: hole_par
        description: "Par for this hole"
      - name: hole_distance
        description: "Distance of this hole in feet"
      - name: tee_latitude
        description: "Tee latitude coordinate"
      - name: tee_longitude
        description: "Tee longitude coordinate"
      - name: basket_latitude
        description: "Basket latitude coordinate"
      - name: basket_longitude
        description: "Basket longitude coordinate"
      - name: doglegs
        description: "Dogleg information for this hole"
      - name: avg_strokes_for_hole
        description: "Average strokes for this hole across all rounds"
      - name: best_score_for_hole
        description: "Best score recorded for this hole"
      - name: worst_score_for_hole
        description: "Worst score recorded for this hole"
      - name: total_attempts_for_hole
        description: "Total number of attempts on this hole"
      - name: strokes_vs_course_avg
        description: "Strokes relative to course average for this hole"
      - name: hole_score
        description: "Score relative to par for this hole"

  - name: dim_target
    description: "Dimension table for disc golf targets (baskets, etc.)"
    columns:
      - name: target_sk
        description: "Surrogate key for the target"
        tests:
          - unique
          - not_null
      - name: target_id
        description: "Original target ID from UDisc"
        tests:
          - unique
      - name: target_type
        description: "Type of target (basket, etc.)"
      - name: target_name
        description: "Name or description of the target"
      - name: target_description
        description: "Additional description of the target"
      - name: created_at
        description: "When the target was first created"
      - name: updated_at
        description: "When the target was last updated"

  - name: dim_tee
    description: "Dimension table for disc golf tees"
    columns:
      - name: tee_sk
        description: "Surrogate key for the tee"
        tests:
          - unique
          - not_null
      - name: tee_id
        description: "Original tee ID from UDisc"
        tests:
          - unique
      - name: tee_type
        description: "Type of tee (pro, amateur, etc.)"
      - name: tee_name
        description: "Name or description of the tee"
      - name: tee_description
        description: "Additional description of the tee"
      - name: created_at
        description: "When the tee was first created"
      - name: updated_at
        description: "When the tee was last updated"

  - name: brg_player_team
    description: "Bridge table linking players to teams for team-based events"
    columns:
      - name: bridge_sk
        description: "Surrogate key for the player-team relationship"
        tests:
          - unique
          - not_null
      - name: player_sk
        description: "Foreign key to dim_player"
        tests:
          - not_null
          - relationships:
              to: ref('dim_player')
              field: player_sk
      - name: team_sk
        description: "Foreign key to dim_team"
        tests:
          - not_null
          - relationships:
              to: ref('dim_team')
              field: team_sk
      - name: is_active
        description: "Whether this player-team relationship is currently active"
      - name: start_date
        description: "When this player joined the team"
      - name: end_date
        description: "When this player left the team (if applicable)"
      - name: created_at
        description: "When this relationship was created"
      - name: updated_at
        description: "When this relationship was last updated"

  - name: fct_throw
    description: "Fact table for individual throws within holes"
    columns:
      - name: throw_sk
        description: "Surrogate key for the throw record"
        tests:
          - unique
      - name: scorecard_id
        description: "Original scorecard ID"
        tests:
          - not_null
      - name: course_sk
        description: "Foreign key to dim_course"
        tests:
          - not_null
          - relationships:
              to: ref('dim_course')
              field: course_sk
      - name: entry_id
        description: "Foreign key to fct_round"
        tests:
          - not_null
          - relationships:
              to: ref('fct_round')
              field: round_id
      - name: player_sk
        description: "Foreign key to dim_player"
        tests:
          - not_null
          - relationships:
              to: ref('dim_player')
              field: player_sk
      - name: hole_number
        description: "Hole number"
        tests:
          - not_null
      - name: hole_strokes
        description: "Number of strokes on this hole"
      - name: throw_number
        description: "Throw number within the hole"
        tests:
          - not_null
      - name: landing_zone
        description: "Where the disc landed (basket, circle1, circle2, etc.)"
      - name: throw_distance
        description: "Distance of this throw in feet"
      - name: cumulative_hole_distance
        description: "Cumulative distance covered on this hole"
      - name: is_final_throw
        description: "Whether this is the final throw on the hole"
      - name: throw_quality
        description: "Quality rating of this throw"
      - name: hole_par
        description: "Par for this hole"
      - name: hole_distance
        description: "Total distance of this hole"
      - name: tee_latitude
        description: "Tee latitude coordinate"
      - name: tee_longitude
        description: "Tee longitude coordinate"
      - name: basket_latitude
        description: "Basket latitude coordinate"
      - name: basket_longitude
        description: "Basket longitude coordinate"
      - name: avg_throw_distance_for_hole
        description: "Average throw distance for this hole"
      - name: shortest_throw_for_hole
        description: "Shortest throw distance for this hole"
      - name: longest_throw_for_hole
        description: "Longest throw distance for this hole"
      - name: distance_vs_course_avg
        description: "Distance relative to course average"
      - name: remaining_distance_to_basket
        description: "Remaining distance to the basket"
      - name: last_updated_at
        description: "When this record was last updated"
